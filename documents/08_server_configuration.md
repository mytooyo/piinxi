# ğŸ“ piinxi Rustã‚µãƒ¼ãƒãƒ¼æ§‹æˆï¼ˆCQRS + BFF + sqlxï¼‰

## ğŸ”¹ ãƒ«ãƒ¼ãƒˆæ§‹æˆä¾‹

```text
piinxi-backend/
â”œâ”€â”€ Cargo.toml
â”œâ”€â”€ .env
â”œâ”€â”€ schema.sql           # DBãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®šç¾©ï¼ˆsqlxå¯¾å¿œï¼‰
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main.rs
â”‚   â”œâ”€â”€ lib.rs
â”‚   â”œâ”€â”€ routes/          # axumãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ï¼ˆHandlerå®šç¾©ï¼‰
â”‚   â”‚   â”œâ”€â”€ mod.rs
â”‚   â”‚   â”œâ”€â”€ users.rs
â”‚   â”‚   â”œâ”€â”€ nests.rs
â”‚   â”‚   â””â”€â”€ piins.rs
â”‚   â”œâ”€â”€ domain/          # ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ï¼ˆDBæ§‹é€ ã«è¿‘ã„ï¼‰
â”‚   â”‚   â”œâ”€â”€ mod.rs
â”‚   â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â”‚   â”œâ”€â”€ user.rs
â”‚   â”‚   â”‚   â”œâ”€â”€ nest.rs
â”‚   â”‚   â”‚   â””â”€â”€ piin.rs
â”‚   â”œâ”€â”€ application/     # CQRSã®ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ï¼ˆDTOå«ã‚€ï¼‰
â”‚   â”‚   â”œâ”€â”€ mod.rs
â”‚   â”‚   â”œâ”€â”€ queries/
â”‚   â”‚   â”‚   â”œâ”€â”€ get_user.rs
â”‚   â”‚   â”‚   â”œâ”€â”€ list_nests.rs
â”‚   â”‚   â”‚   â””â”€â”€ latest_piin.rs
â”‚   â”‚   â”œâ”€â”€ commands/
â”‚   â”‚   â”‚   â”œâ”€â”€ create_user.rs
â”‚   â”‚   â”‚   â”œâ”€â”€ update_user.rs
â”‚   â”‚   â”‚   â””â”€â”€ delete_user.rs
â”‚   â”‚   â”œâ”€â”€ dtos/
â”‚   â”‚   â”‚   â”œâ”€â”€ user_dto.rs
â”‚   â”‚   â”‚   â”œâ”€â”€ nest_dto.rs
â”‚   â”‚   â”‚   â””â”€â”€ piin_dto.rs
â”‚   â”œâ”€â”€ infrastructure/  # å¤–éƒ¨æ¥ç¶šï¼ˆDB, FCMï¼‰
â”‚   â”‚   â”œâ”€â”€ mod.rs
â”‚   â”‚   â”œâ”€â”€ db.rs        # PgPoolç®¡ç†
â”‚   â”‚   â””â”€â”€ repositories/
â”‚   â”‚       â”œâ”€â”€ user_repository.rs
â”‚   â”‚       â”œâ”€â”€ nest_repository.rs
â”‚   â”‚       â””â”€â”€ piin_repository.rs
â”‚   â”œâ”€â”€ config/           # .envèª­ã¿è¾¼ã¿ & ã‚¢ãƒ—ãƒªè¨­å®š
â”‚   â”‚   â””â”€â”€ settings.rs
```

---

## ğŸ§  è£œè¶³ãƒã‚¤ãƒ³ãƒˆ

| ãƒ•ã‚©ãƒ«ãƒ€ | å†…å®¹ |
|---------|------|
| `routes/` | axumã®Handlerã€`GET /users/me`ãªã© |
| `domain/models/` | ç”Ÿã®DBã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ï¼ˆsqlx::FromRowï¼‰ |
| `application/commands/` | æ›¸ãè¾¼ã¿æ“ä½œï¼ˆPOST/PUT/DELETEï¼‰ |
| `application/queries/` | èª­ã¿å–ã‚Šå°‚ç”¨ï¼ˆGETç³»ï¼‰ |
| `application/dtos/` | ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å‘ã‘ã®æ•´å½¢æ¸ˆãƒ¬ã‚¹ãƒãƒ³ã‚¹å‹ |
| `infrastructure/repositories/` | DBæ“ä½œãƒ­ã‚¸ãƒƒã‚¯ï¼ˆç”ŸSQLï¼‰ |

---

## âœ… ç‰¹å¾´çš„ãªè¨­è¨ˆæ„å›³

- **CQRSåˆ†é›¢**ï¼šèª­ã¿å–ã‚Šã¨æ›´æ–°ã‚’ã—ã£ã‹ã‚Šåˆ†ã‘ã¦ç®¡ç†ãƒ»ä¿å®ˆã—ã‚„ã™ã
- **DTOåŒ–**ï¼šã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«æœ€é©åŒ–ã•ã‚ŒãŸæ§‹é€ ã§è¿”å´ã—ã‚„ã™ã„
- **ã‚¯ãƒªãƒ¼ãƒ³ãªè²¬å‹™åˆ†é›¢**ï¼šinfra, domain, application, route ãã‚Œãã‚Œæ˜ç¢º
